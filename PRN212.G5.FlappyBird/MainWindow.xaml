<Window x:Class="PRN212.G5.FlappyBird.Views.MainWindow"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       Title="Flappy Bird" Height="610" Width="1000"
       KeyDown="Window_KeyDown"
       WindowStartupLocation="CenterScreen"
       ResizeMode="NoResize">

    <Grid>
        <!-- ========== DAY LAYER ========== -->
        <Grid x:Name="DayLayer" Panel.ZIndex="0" Opacity="1">
            <Image Source="/Assets/DayStage.jpg"
                   Stretch="UniformToFill"/>
        </Grid>

        <!-- ========== NIGHT LAYER ========== -->
        <Grid x:Name="NightLayer" Panel.ZIndex="1" Opacity="0">
            <Image Source="/Assets/NightStage.jpg"
                   Stretch="UniformToFill"/>
        </Grid>

        <!-- ========== GAME CANVAS (trong suốt, chứa pipes/clouds/bird) ========== -->
        <Canvas x:Name="GameCanvas"
                Background="Transparent"
                Panel.ZIndex="2">

            <Image x:Name="FlappyBird"
                   Width="50" Height="50"
                   Source="/Assets/birdfly-1.png"
                   Canvas.Left="700" Canvas.Top="140"
                   Panel.ZIndex="10"
                   RenderOptions.BitmapScalingMode="HighQuality"/>

            <TextBlock x:Name="ScoreText"
                       Text="Score: 0"
                       FontSize="24"
                       FontWeight="Bold"
                       Foreground="White"
                       Canvas.Left="191" Canvas.Top="10"
                       Panel.ZIndex="8"
                       Visibility="Collapsed"/>

            <TextBlock x:Name="HighScoreText"
                       Text="High Score: 0"
                       FontSize="16"
                       FontWeight="Bold"
                       Foreground="Yellow"
                       Canvas.Left="357" Canvas.Top="19"
                       Panel.ZIndex="8"
                       Visibility="Collapsed"/>
        </Canvas>

        <!-- GAME OVER (polished icon-style overlay) -->
        <Grid x:Name="GameOverPanel"
              Visibility="Collapsed"
              Panel.ZIndex="30"
              Background="#80000000">
            <Grid.Resources>
                <!-- Circular button style -->
                <Style x:Key="CircleButton" TargetType="Button">
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="Background" Value="#2E7D32"/>
                    <Setter Property="BorderBrush" Value="#1B5E20"/>
                    <Setter Property="BorderThickness" Value="2"/>
                    <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
                    <Setter Property="FontSize" Value="28"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="999"
                                        Width="{TemplateBinding Width}"
                                        Height="{TemplateBinding Height}">
                                    <ContentPresenter HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#388E3C"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="#1B5E20"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Grid.Resources>
            <Border Width="460" Padding="20" CornerRadius="16"
                    Background="#CCF0FAFF"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    BorderBrush="#80FFFFFF" BorderThickness="1">
                <StackPanel>
                    <!-- Icon header -->
                    <Grid Margin="0,4,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Border Width="56" Height="56" CornerRadius="28"
                                    Background="#FFEF5350" BorderBrush="#FFE53935" BorderThickness="2"
                                    Margin="0,0,12,0">
                                <TextBlock Text="&#xE7E8;"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="28"
                                           Foreground="White"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="GAME OVER"
                                       FontSize="34"
                                       FontWeight="Black"
                                       Foreground="#0F2D3A"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Grid>

                    <!-- Scores -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="SCORE" FontSize="22" FontWeight="SemiBold" Foreground="#0F2D3A"/>
                        <TextBlock x:Name="GoScoreValue" Grid.Column="1" Text="0" FontSize="22" FontWeight="Bold" Foreground="#0F2D3A"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="BEST SCORE" FontSize="22" FontWeight="SemiBold" Foreground="#0F2D3A"/>
                        <TextBlock x:Name="GoBestScoreValue" Grid.Column="1" Text="0" FontSize="22" FontWeight="Bold" Foreground="#0F2D3A"/>
                    </Grid>

                    <Separator Margin="0,16,0,12" Background="#33000000"/>

                    <!-- Icon buttons -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <!-- Replay -->
                        <StackPanel HorizontalAlignment="Center" Margin="0,0,24,0">
                            <Button Style="{StaticResource CircleButton}"
                                    Width="68" Height="68"
                                    Background="#3B8DAE" BorderBrush="#1E5163"
                                    Click="BtnReplay_Click"
                                    ToolTip="Replay">
                                <TextBlock Text="&#xE72C;" /> <!-- MDL2: Refresh/Replay -->
                            </Button>
                            <TextBlock Text="Replay" Foreground="#0F2D3A" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,6,0,0"/>
                        </StackPanel>

                        <!-- Home/Left -->
                        <StackPanel HorizontalAlignment="Center">
                            <Button Style="{StaticResource CircleButton}"
                                    Width="68" Height="68"
                                    Background="#D68F00" BorderBrush="#845D00"
                                    Click="BtnLeft_Click"
                                    ToolTip="Main Menu">
                                <TextBlock Text="&#xE80F;" /> <!-- MDL2: Home -->
                            </Button>
                            <TextBlock Text="Main menu" Foreground="#0F2D3A" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,6,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
